### 1. 可重入问题

* 可重入性：
  1. 可被多个任务调用而不会造成数据错误
  2. 在任意时刻被中断，稍后继续运行不会造成错误
* 不可重入性
  * 不能被多个任务共享，除非确保函数互斥调用
* 解决方法

```
static int tmp;
void swap(int *a,int *b){  
    tmp=*a;
    *a=*b;
    *b=tmp;
}
```

```
1. 全局变量->局部变量
void swap(int *a,int *b){
    tmp=*a;
    *a=*b;
    *b=tmp;
}
```

```
2. 信号量
static int tmp;
void swap(int *a,int *b){  
    [申请信号量]
    tmp=*a;
    *a=*b;
    *b=tmp;
}
```

```
3. 禁止中断
void swap(int *a,int *b){
    Disable_IRQ();
    tmp=*a;
    *a=*b;
    *b=tmp;
    Enable_IRQ();
  
}
```

### 2. C语言和汇编混合编程

* 汇编调用C
  1. 汇编遵循ATPCS
  2. 在汇编中使用IMPORT伪指令声明调用函数
  3. 通过BL指令调用C函数
* C调用汇编
  1. 汇编遵循ATPCS
  2. 在汇编中使用EXPORT伪指令声明被调用的函数
  3. C中使用extern关键字声明调用函数
* 内联汇编：
  * 可实现部分高级语言实现不了或不易实现的功能
  * 对于时间紧迫要求的功能可以采用
  * 不支持部分底层功能

### 3. 嵌入式存储

* Non-Volatile内存
  * 写平衡：
* 主要技术
  * NAND
  * NOR
* 比较：
  * NAND：单元排列串行，以块和页为单位进行读写，顺序读写，随机读写慢
  * NOR：单元排列并行，以字节为单位进行读写，随机读写快，可以片内执行

### 4. 如何进行嵌入式开发

1. 选择硬件开发平台
2. 建立嵌入式Linux开发环境
   * 宿主机-目标机开发模式
     * 定义：利用PC机开发嵌入式软件
     * 开发过程：
       1. 代码编程->c汇编源程序
       2. 交叉编译->OBJ文件
       3. 通过交叉函数库交叉链接->系统映像文件
       4. 重定向与下载至目标机，可通过宿主机调试
     * 硬件环境：
       * 交叉编译环境：
         * 在一个架构下编译另一个架构的目标文件
         * 交叉编译器和目标文件的格式取决于目标机操作系统
         * 交叉编译工具集：ToolChain
       * 宿主机与目标机的通信：
         * JTag口：
           * 主要功能：测试线路连线和端子的连接状态；测试设备间的连接状态；Flash memory的烧写,程序调试等
         * 实现串口通信：
           * 优点：实现简单
           * 缺点：传输速率慢
           * 配置方法：通过minicom
         * TFTP协议：
           * Trivial File Transfer Protocol
           * 特点：
             * 承载在UDP上
             * 普遍使用第二版TFTP使用UDP的67端口
           * 安装时应设立单独目录作为TFTP服务的根目录，以减少安全隐患
           * 利用TFTP下载Linux映像
     * 软件环境：
       * gdb调试
         * 功能：
           * 检查程序停止时的运行状态
           * 更快改正程序错误
         * 用法：
           * 编译时，需将调试信息加到可执行文件中
           * 使用编译器-g参数
       * 远程调试原理
         * 目标机上具备某种形式的调试代理
         * 符号表驻留在主机端，目标极端工作在无符号状况下
         * 调试器通过某种端口(串口/网络/JTAG)，按预定的通信协议与目标机端的调试代理取得联系
       * 搭建原理
         * stub方案：不依赖于操作系统，可对整个系统进行调试---系统级调试
3. 系统软件开发
   * 建立引导装载程序Bootloader
     * PC机和嵌入式系统的启动过程及其差别
       * PC：系统加电->系统BIOS检测并启动控制卡上的BIOS->将硬盘MBR中的Boot Loader读入系统RAM->交给OS Boot Loader控制->将内核映像从硬盘读入RAM->跳转到内核入口点
       * 嵌入式：加电->引导加载程序(BootLoader等)->操作系统内核->加载文件系统->运行用户程序
     * 什么是BootLoader：
       * 操作系统内核运行之前运行的一小段程序
     * 主要工作
       * 初始化硬件设备和建立内存空间映射图
       * 将系列的软硬件环境带到一个合适的状态
       * 为最终调用操作系统内核准备好正确的环境
   * 嵌入式文件系统
   * 嵌入式设备驱动
   * 嵌入式GUI
4. 嵌入式应用开发

### 5. 嵌入式系统开发模式
